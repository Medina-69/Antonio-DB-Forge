# ğŸ“¦ Medina_ERP.xlsm

**Medina_ERP.xlsm** es un sistema ERP ligero construido sobre Excel y VBA, diseÃ±ado para empresas que desean gestionar Ã³rdenes de compra y venta con autenticaciÃ³n de usuarios y conexiÃ³n directa a bases de datos SQL Server. Este archivo integra formularios interactivos, seguridad por roles y estructuras relacionales, emulando funciones avanzadas de software empresarial sin necesidad de licencias costosas.

---

## ğŸš€ CaracterÃ­sticas principales

- ğŸ” **Inicio de sesiÃ³n con autenticaciÃ³n de usuarios**
- ğŸ­ Control de acceso por **roles personalizados** (Admin, Comprador, Vendedor)
- ğŸ“‹ Registro de Ã³rdenes de compra y venta a travÃ©s de formularios personalizados
- ğŸ§  ConexiÃ³n directa a SQL Server (`Medina_ERP`)
- ğŸ“‘ Consultas en vivo con Power Query (uso controlado)
- ğŸ§¾ Estructura tabular replicable para formularios y lÃ­neas de captura

---

## ğŸ“ Estructura de formularios

### ğŸ”“ UserForm_Users
Formulario de autenticaciÃ³n de acceso seguro.
- Verifica credenciales en la hoja `Usuarios`
- Asigna permisos dinÃ¡micos segÃºn el rol
- Guarda el nombre del usuario autenticado en `Temporales!C4`
- Actualiza hojas y conexiones tras el login

---

### ğŸ›’ frm_OrdenCompra
Formulario para registrar Ã³rdenes de compra.
- Captura campos: `Fecha`, `Id_Proveedor`, `No_Orden`
- Captura hasta 5 lÃ­neas de productos (`SKU`, `Cantidad`, `Costo`, `Descuento`)
- Guarda los datos en la tabla SQL `OrdenesCompra`
- Extrae automÃ¡ticamente el `Id_Proveedor` desde bÃºsqueda inteligente
- Cierra el formulario tras confirmaciÃ³n

---

### ğŸ’° frm_OrdenVenta
Formulario para registrar Ã³rdenes de venta.
- Captura: `Fecha`, `Id_Cliente`, `No_Orden`, `Creator`
- Hasta 10 lÃ­neas dinÃ¡micas de producto (`SKU`, `Cantidad`, `Precio`, `Descuento`)
- Guarda lÃ­nea por lÃ­nea en la tabla SQL `OrdenVenta`
- Cierra al finalizar exitosamente

---

### ğŸ‘¤ BÃºsqueda inteligente de clientes y proveedores
- Campo tipo autocompletado en `TextBox2`
- BÃºsqueda parcial en la vista `vw_Clientes_NombreCompleto` o tabla `Proveedores`
- SelecciÃ³n desde `ListBox1` actualiza automÃ¡ticamente el ID en `TextBox4`

---

## ğŸ› ï¸ ConexiÃ³n con SQL Server

Todas las operaciones se realizan con conexiÃ³n ADODB:
- Base: **`Medina_ERP`**
- Tablas utilizadas: `Clientes`, `Proveedores`, `OrdenVenta`, `OrdenesCompra`
- Vistas usadas: `vw_Clientes_NombreCompleto` (para bÃºsquedas limpias y sin redundancia)

---

## ğŸ” Roles implementados

| Rol        | Hojas habilitadas   | Permisos                                                  |
|------------|---------------------|-----------------------------------------------------------|
| `ADMIN`    | Usuarios, D_Compras, D_Ventas, D_Almacen | Control total                        |
| `COMPRADOR`| D_Compras            | Formulario de Orden de Compra                            |
| `VENDEDOR` | D_Ventas             | Formulario de Orden de Venta                             |
| `ALMACEN`  | D_Almacen            | SerÃ¡ para dar entradas y salidas de material, aun no desarrollado             |

---

## âœ… Requisitos

- Microsoft Excel con soporte para macros (`.xlsm`)
- Acceso a SQL Server con base `Medina_ERP`
- AutenticaciÃ³n habilitada por Windows (SSPI)

---

## ğŸ“Œ Pendientes (To-do)

- [ ] Agregar control de estado de Ã³rdenes (Borrador, Enviada, Procesada)
- [ ] Incluir bitÃ¡cora de movimientos por usuario
- [ ] Formulario de Almacen
- [ ] Conexiones y reportes por rol
- [ ] Exportar reportes resumen en PDF
- [ ] Dashboards conectados a Power BI

---

## ğŸ§  CrÃ©ditos

Desarrollado por [Antonio Medina](#) con la asistencia tÃ©cnica de Copilot â€” el ERP con alma VBA.  
Minimalista, modular y adaptable. Porque no necesitas un monstruo para tener control total.
